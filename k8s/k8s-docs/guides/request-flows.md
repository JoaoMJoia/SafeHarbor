# Request Flows and Architecture Diagrams

## Request Flow

### External Request to Application

```
Internet
    │
    ▼
Load Balancer (Cloud Provider)
    │
    ▼
Service (NodePort/LoadBalancer)
    │
    ▼
kube-proxy (iptables rules)
    │
    ├──► Pod 1
    ├──► Pod 2
    └──► Pod 3
    (Load balanced)
```

### Internal Pod-to-Pod Communication

```
Pod A
    │
    ▼
Cluster Network (CNI)
    │
    ▼
Pod B
    (Direct connection via pod IPs)
```

### Pod-to-Service Communication

```
Pod A
    │
    ▼
Service DNS (CoreDNS)
    │
    ▼
Service IP
    │
    ▼
kube-proxy (iptables)
    │
    ▼
Pod B (selected by load balancing)
```

## Architecture Diagrams

### Complete Kubernetes Architecture

```
┌─────────────────────────────────────────────────────────┐
│                    Control Plane                         │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐             │
│  │API Server│  │Controller │  │Scheduler │             │
│  │          │  │ Manager   │  │          │             │
│  └──────────┘  └──────────┘  └──────────┘             │
│       │              │              │                   │
│       └──────────────┼──────────────┘                   │
│                      │                                  │
│                      ▼                                  │
│                 ┌────────┐                             │
│                 │ etcd   │                             │
│                 └────────┘                             │
└─────────────────────────────────────────────────────────┘
         │                    │                    │
         ▼                    ▼                    ▼
┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐
│   Worker Node 1 │  │   Worker Node 2 │  │   Worker Node 3 │
│  ┌──────────┐   │  │  ┌──────────┐   │  │  ┌──────────┐   │
│  │ kubelet  │   │  │  │ kubelet  │   │  │  │ kubelet  │   │
│  └──────────┘   │  │  └──────────┘   │  │  └──────────┘   │
│  ┌──────────┐   │  │  ┌──────────┐   │  │  ┌──────────┐   │
│  │kube-proxy│   │  │  │kube-proxy│   │  │  │kube-proxy│   │
│  └──────────┘   │  │  └──────────┘   │  │  └──────────┘   │
│  ┌──────────┐   │  │  ┌──────────┐   │  │  ┌──────────┐   │
│  │Container │   │  │  │Container │   │  │  │Container │   │
│  │ Runtime  │   │  │  │ Runtime  │   │  │  │ Runtime  │   │
│  └──────────┘   │  │  └──────────┘   │  │  └──────────┘   │
│  ┌──────────┐   │  │  ┌──────────┐   │  │  ┌──────────┐   │
│  │   Pods   │   │  │  │   Pods   │   │  │  │   Pods   │   │
│  └──────────┘   │  │  └──────────┘   │  │  └──────────┘   │
└─────────────────┘  └─────────────────┘  └─────────────────┘
```

### Component Communication Flow

```
┌─────────────────────────────────────────────────────────┐
│                    Client (kubectl)                      │
└─────────────────────────────────────────────────────────┘
         │
         │ HTTPS
         ▼
┌─────────────────────────────────────────────────────────┐
│                    API Server                            │
│  ┌──────────────────────────────────────────────────┐  │
│  │ Authentication → Authorization → Admission Control│  │
│  └──────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────┘
         │                    │                    │
         │                    │                    │
         ▼                    ▼                    ▼
┌──────────────┐    ┌──────────────┐    ┌──────────────┐
│    etcd      │    │  Controller  │    │  Scheduler   │
│              │    │   Manager    │    │              │
└──────────────┘    └──────────────┘    └──────────────┘
         │                    │                    │
         │                    │                    │
         └────────────────────┼────────────────────┘
                              │
                              ▼
                    ┌──────────────┐
                    │   kubelet    │
                    │  (on nodes)  │
                    └──────────────┘
```

### Pod Lifecycle Management

```
┌─────────────────────────────────────────────────────────┐
│                    User/Controller                       │
│              (Create Pod Request)                        │
└─────────────────────────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────────────────────────┐
│                    API Server                            │
│              (Validate & Store)                          │
└─────────────────────────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────────────────────────┐
│                    Scheduler                             │
│              (Select Node)                               │
└─────────────────────────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────────────────────────┐
│                    kubelet                               │
│  ┌──────────────────────────────────────────────────┐  │
│  │ 1. Pull Image                                    │  │
│  │ 2. Create Container                              │  │
│  │ 3. Setup Network (CNI)                          │  │
│  │ 4. Mount Volumes (CSI)                          │  │
│  │ 5. Start Container                              │  │
│  └──────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────────────────────────┐
│                    Pod Running                           │
└─────────────────────────────────────────────────────────┘
```
